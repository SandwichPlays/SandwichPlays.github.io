<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Model ASCII Viewer</title>
    <style>
        body { font-family: monospace; white-space: pre; margin: 0; background: black; color: green; }
        #ascii-art { text-align: center; }
    </style>
</head>
<body>
    <div id="ascii-art"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/STLLoader.js"></script>
    <script>
        let scene, camera, renderer, controls, asciiArtContainer;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 5);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            const loader = new THREE.STLLoader();
            loader.load('./models/test2.stl', function (geometry) {
                const material = new THREE.MeshNormalMaterial();
                const mesh = new THREE.Mesh(geometry, material);
                scene.add(mesh);

                asciiArtContainer = document.getElementById('ascii-art');
                renderToASCII(mesh);
            });

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.25;
            controls.enableZoom = false;

            animate();
        }

        function renderToASCII(mesh) {
            let ascii = '';
            const textWidth = 80;
            const textHeight = 40;

            for (let y = 0; y < textHeight; y++) {
                for (let x = 0; x < textWidth; x++) {
                    const raycaster = new THREE.Raycaster();
                    const mouse = new THREE.Vector2((x / textWidth) * 2 - 1, -(y / textHeight) * 2 + 1);
                    raycaster.setFromCamera(mouse, camera);

                    const intersects = raycaster.intersectObject(mesh);
                    ascii += intersects.length > 0 ? '#' : ' ';
                }
                ascii += '\n';
            }
            asciiArtContainer.textContent = ascii;
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>
